# ZAP Full Scan Configuration
# Used by: security-scan.sh --zap-full
#
# Format: <rule-id> <action> <name>
#   IGNORE = skip the rule entirely
#   WARN   = report as warning (non-failing)
#   FAIL   = report as failure
#   PASS   = report as pass (override default)
#
# Reference: https://www.zaproxy.org/docs/docker/baseline-scan/#configuration-file

# --- Rules to IGNORE (irrelevant for this demo app) ---

# SQL Injection — no database in this app
40018	IGNORE	SQL Injection
40019	IGNORE	SQL Injection (MySQL)
40020	IGNORE	SQL Injection (Hypersonic)
40021	IGNORE	SQL Injection (Oracle)
40022	IGNORE	SQL Injection (PostgreSQL)
40024	IGNORE	SQL Injection (SQLite)

# LDAP Injection — no LDAP
40015	IGNORE	LDAP Injection

# SOAP/XML — not a SOAP API
90029	IGNORE	SOAP Action Spoofing

# Remote OS Command Injection — Blazor app has no shell exec
90020	IGNORE	Remote OS Command Injection

# External Redirect — demo app has no redirects to external sites
30302	IGNORE	Open Redirect

# --- Rules to WARN (informational, don't fail the scan) ---

# CSP header findings — we WANT to see these but not fail on them
# (the whole point of this project is demonstrating CSP)
10038	WARN	Content Security Policy (CSP) Header Not Set
10055	WARN	CSP: Wildcard Directive
10056	WARN	CSP: script-src unsafe-inline
10057	WARN	CSP: style-src unsafe-inline

# Cookie flags — Blazor's anti-forgery/session cookies
10010	WARN	Cookie No HttpOnly Flag
10011	WARN	Cookie Without Secure Flag
10054	WARN	Cookie without SameSite Attribute

# Information disclosure via headers (server version, etc.)
10036	WARN	Server Leaks Version Information
10037	WARN	Server Leaks Information via X-Powered-By

# Missing anti-CSRF tokens — Blazor uses SignalR, not form POSTs
10202	WARN	Absence of Anti-CSRF Tokens

# Application error disclosure — dev mode may show stack traces
90022	WARN	Application Error Disclosure

# --- Rules to FAIL (real security issues) ---

# XSS — the primary threat CSP protects against
40012	FAIL	Cross Site Scripting (Reflected)
40014	FAIL	Cross Site Scripting (Persistent)
40016	FAIL	Cross Site Scripting (Persistent) - Prime
40017	FAIL	Cross Site Scripting (Persistent) - Spider

# Path traversal
6	FAIL	Path Traversal

# Remote file inclusion
7	FAIL	Remote File Inclusion

# Missing security headers we explicitly set
10021	FAIL	X-Content-Type-Options Header Missing
10020	FAIL	X-Frame-Options Header Not Set
